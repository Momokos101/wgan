# 成员分工说明

## 团队组成

- **后端开发**：1人
- **GAN架构开发**：1人（成员A）
- **GAN应用开发**：1人（成员B）
- **前端开发**：1人

---

## 详细分工

### 👨‍💻 后端开发（第1阶段）

**负责人**：后端开发

**主要职责**：
1. 数据库读取和查询优化
2. 异常检测逻辑的完善和扩展
3. 数据预处理和特征提取
4. 上下文提取逻辑优化

**负责文件**：
```
sequence/
├── db_loader.py              # 数据库加载和异常检测
└── vcu_data_process.py       # 数据处理和特征提取

scripts/vcu/
├── test_vcu_data.py          # 数据加载测试
└── test_context_extraction.py # 上下文提取测试

configs/
└── config_vcu_data.py        # 数据相关配置
    - DB_PATH                  # 数据库路径
    - VEHICLE_STATUS_MIN/MAX   # 异常检测阈值
    - CONTEXT_BEFORE/AFTER     # 上下文提取参数
```

**工作内容**：
- ✅ 从数据库读取测试数据
- ✅ 识别异常数据点（动力防盗标识位与整车状态不匹配等）
- ✅ 提取CC2电压序列
- ✅ 以异常点为中心提取上下文（向前N个、向后M个唤醒电压）
- ✅ 提取电压特征（震荡顶峰、连续极大值、边界值等）
- ✅ 构建条件向量（9维：基础3 + 异常类型1 + 电压特征5）

**输出**：
- 处理好的训练数据（电压序列、条件向量、异常标签）
- 数据测试脚本和测试结果

**时间顺序**：**第1阶段**（必须先完成，其他成员依赖此阶段）

---

### 🧠 GAN架构开发（第2阶段）

**负责人**：GAN架构开发（成员A）

**主要职责**：
1. GAN模型架构设计（生成器和判别器）
2. WGAN-GP训练框架实现
3. 条件生成机制
4. 训练稳定性优化

**负责文件**：
```
nn/
├── model.py                  # 基础模型类（NetModel）
├── conv1d.py                 # Conv1D模型实现（生成器和判别器）
├── trainer.py                 # 训练器基类
├── wd_trainer.py             # WGAN-GP训练器（WassersteinTrainer）
└── optimizer.py              # 优化器配置

configs/
└── config_vcu_model.py       # 模型相关配置
    - Z_DIM                    # 噪声向量维度
    - EMBEDDING_DIM            # 嵌入维度
    - G_DIM                    # 生成器维度
    - D_DIM                    # 判别器维度
    - OPT_TYPE                 # 优化器类型
```

**工作内容**：
- ✅ 设计生成器网络（输入：条件向量 + 噪声，输出：电压序列）
- ✅ 设计判别器网络（输入：电压序列 + 条件向量，输出：真实/虚假评分）
- ✅ 实现WGAN-GP损失函数和梯度惩罚
- ✅ 实现条件生成机制（根据异常类型和电压特征生成序列）
- ✅ 优化训练稳定性（学习率调整、梯度裁剪等）

**依赖**：
- ⚠️ 需要后端提供的数据格式（电压序列、条件向量）
- ⚠️ 需要了解条件向量维度（C_DIM = 9）

**时间顺序**：**第2阶段**（依赖第1阶段完成）

---

### 🚀 GAN应用开发（第3阶段）

**负责人**：GAN应用开发（成员B）

**主要职责**：
1. 训练脚本编写和优化
2. 生成脚本编写和优化
3. 序列评分和筛选
4. 模型评估和性能分析

**负责文件**：
```
scripts/vcu/
├── train_vcu.py              # 训练脚本
├── generate_vcu.py           # 生成脚本（使用训练好的模型）
└── generate_vcu_simple.py    # 生成脚本（使用未训练模型）

nn/
└── load_model.py             # 模型加载工具

configs/
└── config_vcu_train.py      # 训练相关配置
    - MAX_EPOCH               # 训练轮数
    - BATCH_SIZE              # 批次大小
    - STAGEI_G_LR             # 生成器学习率
    - STAGEI_D_LR             # 判别器学习率
    - DECAY                   # 学习率衰减
```

**工作内容**：
- ✅ 编写训练流程（数据加载、模型构建、训练循环、模型保存）
- ✅ 编写生成流程（加载模型、条件生成、序列评分、十六进制输出）
- ✅ 实现序列评分机制（高风险区间、极值点、振荡强度等）
- ✅ 实现多种生成策略（按异常类型生成、边界震荡型、强振荡型等）
- ✅ 模型性能评估（生成质量、异常触发率等）

**依赖**：
- ⚠️ 需要后端提供的数据处理模块
- ⚠️ 需要GAN架构提供的模型接口

**时间顺序**：**第3阶段**（依赖第1、2阶段完成）

---

### 🎨 前端开发（第4阶段）

**负责人**：前端开发

**主要职责**：
1. 训练监控界面
2. 生成序列展示
3. 数据可视化
4. 前后端对接

**负责文件**：
```
frontend/                     # 前端项目目录（新建）
├── src/
│   ├── components/           # 组件
│   ├── api/                 # API调用
│   └── utils/               # 工具函数
└── ...
```

**工作内容**：
- ✅ 训练过程可视化（损失曲线、训练进度）
- ✅ 生成序列展示（电压序列图表、十六进制格式）
- ✅ 异常数据统计和可视化
- ✅ 前后端API对接

**依赖**：
- ⚠️ 需要后端提供API接口（如需要）
- ⚠️ 需要GAN应用提供生成结果

**时间顺序**：**第4阶段**（依赖第1、2、3阶段完成）

---

## 工作顺序和时间线

```
阶段1：后端开发（1-2周）
  ↓
  ├─ 数据库读取和异常检测
  ├─ 数据预处理和特征提取
  └─ 输出：处理好的训练数据
       ↓
阶段2：GAN架构开发（2-3周）
  ↓
  ├─ 模型架构设计
  ├─ 训练框架实现
  └─ 输出：可用的GAN模型
       ↓
阶段3：GAN应用开发（1-2周）
  ↓
  ├─ 训练脚本编写
  ├─ 生成脚本编写
  └─ 输出：训练好的模型和生成序列
       ↓
阶段4：前端开发（1-2周）flask框架
  ↓
  ├─ 界面开发
  ├─ 数据可视化
```

## 接口定义

### 后端 → GAN架构

**数据处理接口**：
```python
# sequence/vcu_data_process.py
class VcuDataProcessor:
    def process_data(self, limit=None) -> Tuple:
        """
        返回: (train_data, test_data, max_sequence_length)
        train_data: tf.data.Dataset，每个元素是 (voltage_seq, condition, abnormal_label)
        """
        pass
```

### GAN架构 → GAN应用

**模型接口**：
```python
# nn/scale_model.py
class ScaleModel:
    def build(self):
        """构建模型"""
        pass
    
    def generate_wc(self, condition):
        """
        条件生成
        输入: condition (形状: [batch_size, C_DIM])
        输出: generated_sequence (形状: [batch_size, sequence_length])
        """
        pass
```

## 配置文件分工

配置文件已拆分，每个人负责自己的配置文件：

| 配置文件 | 负责人 | 主要配置项 |
|---------|--------|-----------|
| `config_vcu_base.py` | 所有人（需讨论） | 基础配置、路径、条件维度 |
| `config_vcu_data.py` | 后端开发 | 数据库路径、异常阈值、上下文参数 |
| `config_vcu_model.py` | GAN架构开发 | 模型维度、优化器类型 |
| `config_vcu_train.py` | GAN应用开发 | 训练轮数、学习率、批次大小 |

## 协作要点

1. **接口稳定**：定义好接口后，尽量避免频繁变更
2. **及时沟通**：遇到接口变更或问题，及时在团队群中讨论
3. **测试验证**：每个阶段完成后，进行测试确保功能正常
4. **文档更新**：接口变更时，及时更新文档

## 总结

- **后端开发**：第1阶段，提供数据基础
- **GAN架构开发**：第2阶段，提供模型基础
- **GAN应用开发**：第3阶段，实现训练和生成
- **前端开发**：第4阶段，提供用户界面

每个阶段都有明确的输入和输出，确保工作有序进行！

